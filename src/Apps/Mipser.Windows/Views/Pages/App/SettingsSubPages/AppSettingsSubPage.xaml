<?xml version="1.0" encoding="utf-8"?>
<UserControl
    x:Class="Mipser.Windows.Views.Pages.App.SettingsSubPages.AppSettingsSubPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:base="using:Mipser.Windows.Views.Pages.App"
    xmlns:local="using:Mipser.Windows.Views.Pages.App.SettingsSubPages"
    xmlns:ctc="using:CommunityToolkit.WinUI.Controls"
    xmlns:models="using:Mipser.Models"
    xmlns:helpers="using:Mipser.Windows.Helpers"
    xmlns:senums="using:Mipser.Services.Settings.Enums"
    mc:Ignorable="d">

    <StackPanel>
        <StackPanel.ChildrenTransitions>
            <EntranceThemeTransition FromVerticalOffset="50" IsStaggeringEnabled="True" />
        </StackPanel.ChildrenTransitions>
        
        <ctc:SettingsCard x:Uid="/Settings/AppThemeSC"
                          Header="Theme"
                          Description="Change the app's theme.">
            <ctc:SettingsCard.HeaderIcon>
                <FontIcon FontFamily="Segoe Fluent Icons" Glyph="&#xE2B1;" />
            </ctc:SettingsCard.HeaderIcon>
            <ComboBox SelectedItem="{x:Bind ViewModel.AppTheme, Mode=TwoWay}"
                      ItemsSource="{x:Bind ViewModel.AppThemeOptions, Mode=OneWay}">
                <ComboBox.ItemTemplate>
                    <DataTemplate x:DataType="senums:Theme">
                        <TextBlock Text="{x:Bind helpers:LocalizationHelper.Localize((senums:Theme)), Mode=OneWay}"/>
                    </DataTemplate>
                </ComboBox.ItemTemplate>
            </ComboBox>
        </ctc:SettingsCard>

        <!--<ctc:SettingsCard x:Uid="/Settings/RestoreOpenProjectSC"
                          Header="Restore Open Project/Folder"
                          Description="Set whether or not the app should cache and restore the open the project/folder when opened.">
            <ToggleSwitch IsOn="{x:Bind ViewModel.RestoreOpenProject, Mode=TwoWay}"/>
        </ctc:SettingsCard>-->

        <ctc:SettingsCard x:Uid="/Settings/AppLanguageSC"
                          Header="App Language"
                          Description="Set the app's display language. (Requires a restart to take effect).">
            <ctc:SettingsCard.HeaderIcon>
                <FontIcon FontFamily="Segoe Fluent Icons" Glyph="&#xE774;" />
            </ctc:SettingsCard.HeaderIcon>
            <ComboBox SelectedItem="{x:Bind ViewModel.LanguageOverride, Mode=TwoWay}"
                      ItemsSource="{x:Bind ViewModel.AppLanguageOptions, Mode=OneWay}">
                <ComboBox.ItemTemplate>
                    <DataTemplate x:DataType="x:String">
                        <TextBlock Text="{x:Bind base:SettingsPage.LanguageDisplayName((x:String)), Mode=OneWay}"/>
                    </DataTemplate>
                </ComboBox.ItemTemplate>
            </ComboBox>
        </ctc:SettingsCard>

        <ctc:SettingsExpander x:Uid="/Settings/AboutSE"
                              Header="MIPSer"
                              Description="Â© Avishai Dernis">
            <ctc:SettingsExpander.HeaderIcon>
                <ImageIcon Source="{StaticResource AppIconSmall}"/>
            </ctc:SettingsExpander.HeaderIcon>
            <ctc:SettingsExpander.Content>
                <TextBlock Text="{x:Bind ViewModel.AppVersion, Mode=OneWay}"
                           Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                           IsTextSelectionEnabled="True"/>
            </ctc:SettingsExpander.Content>
            <ctc:SettingsExpander.Items>
                <ctc:SettingsCard HorizontalContentAlignment="Left"
                                  ContentAlignment="Left">
                    <StackPanel Margin="-24,0,0,0" Orientation="Horizontal" Spacing="8">
                        <HyperlinkButton NavigateUri="https://github.com/Avid29/MIPSer">
                            <StackPanel Orientation="Horizontal" Spacing="8">
                                <ImageIcon Source="{ThemeResource GitHubIcon}" Height="20"/>
                                <TextBlock x:Uid="/Settings/ViewOnGitHubTB" Text="View on GitHub"/>
                            </StackPanel>
                        </HyperlinkButton>

                        <HyperlinkButton NavigateUri="{x:Bind ViewModel.CommitGitHubLink, Mode=OneWay}">
                            <StackPanel Orientation="Horizontal" Spacing="4">
                                <ImageIcon Source="{StaticResource GitServiceIcon}" Height="20"/>
                                <RichTextBlock IsTextSelectionEnabled="False">
                                    <Paragraph>
                                        <Run Text="{x:Bind ViewModel.GitInfo.Branch}"/>
                                        <Run Text="/"/>
                                        <Run Text="{x:Bind ViewModel.GitInfo.Commit}"/>
                                    </Paragraph>
                                </RichTextBlock>
                            </StackPanel>
                        </HyperlinkButton>
                    </StackPanel>
                </ctc:SettingsCard>
                <ctc:SettingsCard HorizontalContentAlignment="Left"
                                  ContentAlignment="Left">
                    <StackPanel Spacing="8">
                        <TextBlock x:Uid="/Settings/ThirdPartyDependenciesTB" Text="Third-Party Dependencies" FontSize="18"/>
                        <ItemsRepeater ItemsSource="{x:Bind ViewModel.ThirdPartyNotices, Mode=OneWay}">
                            <ItemsRepeater.ItemTemplate>
                                <DataTemplate x:DataType="models:ThirdPartyNotice">
                                    <HyperlinkButton Content="{x:Bind DependencyName, Mode=OneWay}" NavigateUri="{x:Bind Url, Mode=OneWay}"/>
                                </DataTemplate>
                            </ItemsRepeater.ItemTemplate>
                        </ItemsRepeater>
                    </StackPanel>
                </ctc:SettingsCard>
                <ctc:SettingsCard x:Uid="/Settings/MadeInIsraelSC"
                                  Header="Hello from Tel Aviv"
                                  Description="Made in Israel">
                    <ctc:SettingsCard.HeaderIcon>
                        <ImageIcon Source="{StaticResource IsraelFlagIcon}"/>
                    </ctc:SettingsCard.HeaderIcon>
                </ctc:SettingsCard>
            </ctc:SettingsExpander.Items>
        </ctc:SettingsExpander>
    </StackPanel>
</UserControl>
