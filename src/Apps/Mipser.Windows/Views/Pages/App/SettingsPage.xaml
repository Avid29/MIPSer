<?xml version="1.0" encoding="utf-8"?>
<UserControl
    x:Class="Mipser.Windows.Views.Pages.App.SettingsPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:local="using:Mipser.Windows.Views.Pages.App"
    xmlns:ctc="using:CommunityToolkit.WinUI.Controls"
    xmlns:helpers="using:Mipser.Windows.Helpers"
    xmlns:selectors="using:Mipser.Windows.Selectors"
    xmlns:senums="using:Mipser.Services.Settings.Enums"
    xmlns:subvms="using:Mipser.ViewModels.Pages.App.Settings"
    xmlns:subs="using:Mipser.Windows.Views.Pages.App.SettingsSubPages"
    mc:Ignorable="d">

    <ScrollViewer>
        <VisualStateManager.VisualStateGroups>
            <VisualStateGroup>
                <VisualState>
                    <VisualState.StateTriggers>
                        <AdaptiveTrigger MinWindowWidth="1280"/>
                    </VisualState.StateTriggers>
                    <VisualState.Setters>
                        <Setter Target="ContentDisplay.MaxWidth" Value="2000"/>
                        <Setter Target="LeftGutter.Width" Value="0.5*"/>
                        <Setter Target="RightGutter.Width" Value="0.5*"/>
                    </VisualState.Setters>
                </VisualState>
            </VisualStateGroup>
        </VisualStateManager.VisualStateGroups>

        <Grid Margin="16">
            <Grid.RowDefinitions>
                <RowDefinition Height="auto"/>
                <RowDefinition/>
            </Grid.RowDefinitions>
            
            <Grid.ColumnDefinitions>
                <ColumnDefinition x:Name="LeftGutter" Width="auto"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition x:Name="RightGutter" Width="auto"/>
            </Grid.ColumnDefinitions>
            
            <ctc:Segmented x:Name="SegmentedPageSelector"
                           ItemsSource="{x:Bind ViewModel.SubPages}"
                           HorizontalAlignment="Center"
                           SelectedIndex="0"
                           Grid.ColumnSpan="3"
                           Margin="8,8,8,32">
                <ctc:Segmented.ItemTemplate>
                    <DataTemplate x:DataType="subvms:SettingsSubPageViewModel">
                        <TextBlock Text="{x:Bind Title}" />
                    </DataTemplate>
                </ctc:Segmented.ItemTemplate>
            </ctc:Segmented>

            <ContentControl x:Name="ContentDisplay"
                            Content="{x:Bind SegmentedPageSelector.SelectedItem, Mode=OneWay}"
                            Grid.Column="1" Grid.Row="1"
                            MaxWidth="800"
                            HorizontalContentAlignment="Stretch">
                <ContentControl.ContentTemplateSelector>
                    <selectors:SettingsSubPageTemplateSelector>
                        <selectors:SettingsSubPageTemplateSelector.AppPageTemplate>
                            <DataTemplate x:DataType="subvms:AppSettingsViewModel">
                                <subs:AppSettingsSubPage ViewModel="{x:Bind}"/>
                            </DataTemplate>
                        </selectors:SettingsSubPageTemplateSelector.AppPageTemplate>
                        <selectors:SettingsSubPageTemplateSelector.AssemblerPageTemplate>
                            <DataTemplate x:DataType="subvms:AssemblerSettingsViewModel">
                                <subs:AssemblerSettingsSubPage ViewModel="{x:Bind}"/>
                            </DataTemplate>
                        </selectors:SettingsSubPageTemplateSelector.AssemblerPageTemplate>
                        <selectors:SettingsSubPageTemplateSelector.EditorPageTemplate>
                            <DataTemplate x:DataType="subvms:EditorSettingsViewModel">
                                <subs:EditorSettingsSubPage ViewModel="{x:Bind}"/>
                            </DataTemplate>
                        </selectors:SettingsSubPageTemplateSelector.EditorPageTemplate>
                    </selectors:SettingsSubPageTemplateSelector>
                </ContentControl.ContentTemplateSelector>
            </ContentControl>

        </Grid>
    </ScrollViewer>
</UserControl>
